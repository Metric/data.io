var events=require("events"),wss=require("ws").Server,async=require("async"),Socket=require("./lib/Socket"),http=require("http"),https=require("https"),DataIO=function(){this.sockets=[],this.init.apply(this,arguments)};DataIO.prototype=Object.create(events.EventEmitter.prototype),DataIO.prototype.init=function(t){var e=this;return"string"==typeof t?this.wss=new wss({host:t}):"number"==typeof t?this.wss=new wss({port:t}):"object"==typeof t?this.wss=new wss({server:t}):this.wss=new wss({port:8080}),this.wss.on("connection",function(t){var s=new Socket(t);e.sockets.push(s),s.on("close",function(){e.sockets.splice(e.sockets.indexOf(this),1)}),e._emit("connection",s)}),this},DataIO.prototype._emit=DataIO.prototype.emit,DataIO.prototype.emit=function(){var t=Array.prototype.slice.apply(arguments);return async.each(this.sockets,function(e,s){e.emit.apply(e,t),s()},function(t){}),this},module.exports=exports=DataIO;